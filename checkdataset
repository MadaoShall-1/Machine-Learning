# check_dataset.py
from huggingface_hub import HfApi
from datasets import load_dataset

def check_switchlingua():
    """æ£€æŸ¥ SwitchLingua æ•°æ®é›†çŠ¶æ€"""
    
    print("="*60)
    print("æ£€æŸ¥ SwitchLingua æ•°æ®é›†")
    print("="*60)
    
    # 1. æ£€æŸ¥æ•°æ®é›†æ˜¯å¦å­˜åœ¨
    api = HfApi()
    dataset_name = "Shelton1013/SwitchLingua_text"
    
    print(f"\n1ï¸âƒ£ æ£€æŸ¥æ•°æ®é›†: {dataset_name}")
    try:
        info = api.dataset_info(dataset_name)
        print(f"   âœ… æ•°æ®é›†å­˜åœ¨ï¼")
        print(f"   - ä½œè€…: {info.author}")
        print(f"   - æ˜¯å¦éœ€è¦é—¨æ§: {info.gated}")
        print(f"   - ä¸‹è½½é‡: {info.downloads}")
        
        # å¦‚æœæ˜¯é—¨æ§æ•°æ®é›†
        if info.gated:
            print(f"\n   âš ï¸ è¿™æ˜¯ä¸€ä¸ªéœ€è¦ç”³è¯·è®¿é—®çš„æ•°æ®é›† (Gated Dataset)")
            print(f"   ğŸ“ è¯·è®¿é—®ä»¥ä¸‹é“¾æ¥ç”³è¯·è®¿é—®:")
            print(f"   ğŸ”— https://huggingface.co/datasets/{dataset_name}")
            
    except Exception as e:
        print(f"   âŒ æ— æ³•è®¿é—®æ•°æ®é›†")
        print(f"   é”™è¯¯: {e}")
        return False
    
    # 2. å°è¯•åŠ è½½æ•°æ®é›†
    print(f"\n2ï¸âƒ£ å°è¯•åŠ è½½æ•°æ®é›†...")
    try:
        dataset = load_dataset(dataset_name, split="train[:5]")
        print(f"   âœ… æˆåŠŸåŠ è½½æ•°æ®é›†ï¼")
        print(f"   - æ ·æœ¬æ•°: {len(dataset)}")
        print(f"   - å­—æ®µ: {dataset.column_names}")
        
        print(f"\n3ï¸âƒ£ ç¬¬ä¸€æ¡æ ·æœ¬:")
        sample = dataset[0]
        for key, value in sample.items():
            if isinstance(value, str) and len(value) > 100:
                print(f"   {key}: {value[:100]}...")
            else:
                print(f"   {key}: {value}")
        
        return True
        
    except Exception as e:
        error_msg = str(e)
        print(f"   âŒ æ— æ³•åŠ è½½æ•°æ®é›†")
        print(f"   é”™è¯¯: {error_msg}")
        
        # æ ¹æ®é”™è¯¯ç±»å‹ç»™å‡ºå»ºè®®
        if "401" in error_msg or "Unauthorized" in error_msg:
            print(f"\n   ğŸ’¡ å»ºè®®:")
            print(f"   1. ç¡®è®¤å·²ç»è¿è¡Œ 'huggingface-cli login'")
            print(f"   2. æ£€æŸ¥ token æ˜¯å¦æœ‰æ•ˆ")
            
        elif "403" in error_msg or "Forbidden" in error_msg or "gated" in error_msg.lower():
            print(f"\n   ğŸ’¡ å»ºè®®:")
            print(f"   1. è®¿é—® https://huggingface.co/datasets/{dataset_name}")
            print(f"   2. æŸ¥æ‰¾ 'Request Access' æˆ– 'Access repository' æŒ‰é’®")
            print(f"   3. åŒæ„æ¡æ¬¾å¹¶ç”³è¯·è®¿é—®")
            print(f"   4. ç­‰å¾…æ‰¹å‡†ï¼ˆå¯èƒ½æ˜¯å³æ—¶çš„ï¼‰")
            
        elif "404" in error_msg or "not found" in error_msg.lower():
            print(f"\n   ğŸ’¡ å»ºè®®:")
            print(f"   1. æ£€æŸ¥æ•°æ®é›†åç§°æ˜¯å¦æ­£ç¡®")
            print(f"   2. æ•°æ®é›†å¯èƒ½å·²è¢«åˆ é™¤æˆ–æ”¹å")
            
        return False

if __name__ == "__main__":
    check_switchlingua()